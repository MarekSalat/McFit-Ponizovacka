<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="/css/normalize.css">
        <link rel="stylesheet" href="/css/main.css">
        <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,400italic' rel='stylesheet' type='text/css'>
        <script src="/js/vendor/modernizr-2.6.2.min.js"></script>

        <script>
            var connection;
            window.addEventListener("load", function () {
                var nickname = 'Foo';//prompt("Choose a nickname");
                if (!nickname)
                    return;

                connection = new WebSocket("ws://" + window.location.hostname + ":8081");
                connection.onopen = function () {
                    connection.send(JSON.stringify({
                        type: 'CONTROLLER_NEW',
                        nickname: nickname
                    }));
                };
                connection.onclose = function () {
                    console.log("Connection closed");
                };
                connection.onerror = function () {
                    console.error("Connection error");
                };
                connection.onmessage = function (event) {
                    $('#debug').append('\n' + JSON.stringify(JSON.parse(event.data),null,2));
                }

               $('#throw').click(function (e){
                   console.log(e);

                   var request = {
                       type: 'CONTROLLER_THROW',
                       event: e.type
                   };
//                   $('#debug').append('\n' + JSON.stringify(request,null,2));
                   connection.send(JSON.stringify(request));
               });
            })
        </script>
        <style>
            * {
                font-family: 'PT Sans', sans-serif;
            }
            .throw {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
            }
            
            .throw .message {
                padding-top: 20%;
                text-align: center;
                vertical-align: middle;
                font-size: 10em;
            }
        </style>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <div class="throw">
            <!-- Click to start humiliation!!! -->
            <!-- Throw potato -->
            <!-- Slap him -->
            <div class="message">Click to throw</div>
        </div>

        <div id="throw" class="throw"></div>

        <pre id="debug">
        </pre>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
        <script src="/js/plugins.js"></script>
    </body>
</html>
